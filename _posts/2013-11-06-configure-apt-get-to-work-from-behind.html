---
layout: post
title: Configure apt-get to work from behind the proxy server
date: '2013-11-06T12:22:00.002-08:00'
author: Sumit Agrawal
tags: 
modified_time: '2013-11-08T08:59:47.131-08:00'
blogger_id: tag:blogger.com,1999:blog-680750426739773469.post-6065316788619987152
blogger_orig_url: http://codewithgeeks.blogspot.com/2013/11/configure-apt-get-to-work-from-behind.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">I have divided this tutorial in three parts.<br /><div><br /></div><div>In the first part we enable proxy authentication for all bash commands.</div><div>In the second part of this tutorial, I will describe the procedure for enabling proxy authentication for aptitude package manager or famously known as APT.&nbsp;</div><div>The third part deals with bit of security and gives more insight of the chmod command.&nbsp;</div><div><br /></div><div><b>Part I: Edit bash.bashrc.</b></div><div><br /></div><div>bash.bashrc is configuration file for the bash shell. There are lot of ways in which you can customize shell experience using this file. For editing bash.bashrc you need to be root. Run following command to open this file with root privileges <br /><br /><pre style="background-color: #eeeeee; border: 0px; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; font-size: 14px; line-height: 18px; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;"><span style="color: #222222;">$ gksudo gedit</span></pre></div><div>You will be asked to authenticate, enter password for the admin account.&nbsp;</div><div>Now from gedit open /etc/bash.bashrc and add following lines at the end of this file</div><div><br /></div><div><pre style="background-color: #eeeeee; border: 0px; color: #333333; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; font-size: 14px; line-height: 18px; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;"><code style="border: 0px; color: #222222; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; margin: 0px; padding: 0px; vertical-align: baseline;">Export http_proxy = http://username:password@proxyserver:port/<br /></code><span style="color: #222222;">Export https_proxy = http://username:password@proxyserver:port/<br /></span><span style="color: #222222;">Export ftp_proxy = http://username:password@proxyserver:port/</span></pre></div><div><br /></div><div>where &lt;username&gt; is your username and &lt;password&gt; is your password.&nbsp;</div><div>For example:</div><div><br /></div><div><div><pre style="background-color: #eeeeee; border: 0px; color: #333333; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; font-size: 14px; line-height: 18px; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;"><code style="border: 0px; color: #222222; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; margin: 0px; padding: 0px; vertical-align: baseline;">Export http_proxy = http://sumit:password@10.10.1.1:3128/<br /></code><span style="color: #222222;">Export https_proxy = http://sumit:password@10.10.1.1:3128/<br /></span><span style="color: #222222;">Export ftp_proxy = http://sumit:password@10.10.1.1:3128/</span></pre></div></div><div>Save this file.&nbsp;</div><div><br /></div><div style="text-align: left;"><div style="text-align: left;"><b>Part II: Edit apt.conf&nbsp;</b></div></div><div style="text-align: left;"><b><br /></b></div><div>As you might have guessed, apt.conf is configuration file for APT. Once again run gedit in root mode</div><div>using&nbsp;</div><div><br /></div><div><div><pre style="background-color: #eeeeee; border: 0px; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; font-size: 14px; line-height: 18px; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;"><span style="color: #222222;">$ gksudo gedit</span></pre></div></div><div><span style="color: #222222;"><br /></span></div><div>From /etc/apt/ open apt.conf file.&nbsp;</div><div>[Depending on your Linux distribution this file may be absent in that directory, in which case you should create new file and save it as apt.conf in /etc/apt/ ].</div><div><br /></div><div>Add following details to this file:</div><div><br /></div><div><pre style="background-color: #eeeeee; border: 0px; color: #333333; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; font-size: 14px; line-height: 18px; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;"><pre style="border: 0px; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;"><code style="border: 0px; color: #222222; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; margin: 0px; padding: 0px; vertical-align: baseline;">Acquire::http::proxy "http://username:password@proxyserver:port/";<br />Acquire::https::proxy "https://username:password@proxyserver:port/";<br />Acquire::socks::proxy "socks://username:password@proxyserver:port/";</code><br /></pre></pre><div>This should get APT working on your system. But as you may have already noticed that these two files are stored as a plain text and anyone can open and read these files. To prevent this threat you can use chmod which stands for 'change mode'.<br /><br /><a name='more'></a><br /><br /><b>Part III: Understanding chmod command</b><br /><br />Every file has three permissions to set, namely read, write and execute.<br />You can confirm the permissions set for bash.bashrc using following command<br /><br /><div><div><pre style="background-color: #eeeeee; border: 0px; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; font-size: 14px; line-height: 18px; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;"><span style="color: #222222;">$ ls -l /etc/bash.bashrc | grep bash.bashrc</span></pre></div></div><div><span style="color: #222222;"><br />In this command <i>ls</i> lists all the files specified in the <i>/etc/bash.bashrc</i> directory.</span><br /><span style="color: #222222;">The<i> -l</i> switch ensures that the every information of file is displayed on the terminal. Since list obtained by <i>ls</i> can be very long we pass [pipe] this output to another program <i>grep</i> which searches for specified text in the output.&nbsp;</span><br /><span style="color: #222222;"><br /></span><br /><div><div><pre style="background-color: #eeeeee; border: 0px; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; font-size: 14px; line-height: 18px; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;"><span style="color: #222222;">$ -<u>rwx</u> <u>r-x</u> <u>r-x</u> administrator administrator 2191 Oct 28 09:53 /etc/<b>bash.bashrc</b></span></pre></div></div><span style="color: #222222;">grep will change the color of matched text i.e. bash.bashrc in the output.&nbsp;</span></div><div><span style="color: #222222;"><br /></span></div>First three underlined groups represent the permissions set associated with this file. First group i.e <i>rwx </i>in this case represents permissions for current user. Other two groups <i>r-x&nbsp; </i>indicate that other users are allowed to read and execute this file but they are not allowed to write on this file. In ideal case other users should only be able to execute this file i.e. the permissions for this file should be set to <i>-rwx --x --x</i><b>. </b>For this execute following command <br /><br /><div><div><pre style="background-color: #eeeeee; border: 0px; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; font-size: 14px; line-height: 18px; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;"><span style="color: #222222;">$ chmod 711 /etc/bash.bashrc </span></pre></div></div><b>&nbsp;</b>Refer to this table before setting permissions<br /><br /><pre style="background-color: #eeeeee; border: 0px; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; font-size: 14px; line-height: 18px; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;"><span style="color: #222222;">read write execute no. permissions</span></pre><pre style="background-color: #eeeeee; border: 0px; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; font-size: 14px; line-height: 18px; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;">1    1     1       7   read, write, execute<br />1    1     0       6   read, write<br />1    0     1       5   read, execute<br />1    0     0       4   read <br />0    1     1       3   write, execute<br />0    1     0       2   write<br />0    0     1       1   execute<br />0    0     0       0   no-permissions</pre>It is very clear from the table that the number <i>711 </i>sets read, write and execute for current user and only execute permission for all other users.<br />Confirm this using <br /><br /><pre style="background-color: #eeeeee; border: 0px; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; font-size: 14px; line-height: 18px; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;"><span style="color: #222222;">$ ls -l /etc/bash.bashrc | grep bash.bashrc</span></pre>You should get following result. <br /><br /><div><div><pre style="background-color: #eeeeee; border: 0px; font-family: 'Ubuntu Mono', 'Ubuntu Beta Mono A', Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace; font-size: 14px; line-height: 18px; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;"><span style="color: #222222;">$ -<u>rwx</u> <u>--x</u> <u>--x</u> administrator administrator 2191 Oct 28 09:53 /etc/<b>bash.bashrc</b></span></pre></div></div></div></div></div>